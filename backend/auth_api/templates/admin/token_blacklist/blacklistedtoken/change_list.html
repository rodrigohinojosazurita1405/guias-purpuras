{% extends "admin/change_list.html" %}
{% load static %}

{% block content_title %}
<h1>Lista Negra de Tokens (Blacklist)</h1>
{% endblock %}

{% block object-tools %}
{{ block.super }}

<div style="margin-top: 20px; padding: 20px; background: linear-gradient(135deg, #7C3AED 0%, #5B21B6 100%); border-radius: 12px; box-shadow: 0 4px 12px rgba(124, 58, 237, 0.3);">
    <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 16px;">
        <div style="flex: 1; min-width: 250px;">
            <h3 style="color: white; margin: 0 0 8px 0; font-size: 18px; font-weight: 700;">
                Gestión de Tokens
            </h3>
            <p style="color: rgba(255, 255, 255, 0.9); margin: 0; font-size: 14px; line-height: 1.6;">
                {% if expired_blacklisted > 0 %}
                    <strong>{{ expired_blacklisted }}</strong> token(s) expirado(s) detectado(s).
                    {% if cleanup_needed %}
                        <span style="display: inline-block; background: #FEF3C7; color: #78350F; padding: 4px 10px; border-radius: 12px; font-size: 12px; font-weight: 700; margin-left: 8px;">
                            ⚠️ LIMPIEZA RECOMENDADA
                        </span>
                    {% endif %}
                {% else %}
                    Base de datos limpia - No hay tokens expirados.
                {% endif %}
            </p>
        </div>

        <a href="{% url 'admin:clean_tokens' %}"
           style="display: inline-flex; align-items: center; gap: 8px; background: white; color: #7C3AED; padding: 14px 24px; border-radius: 8px; text-decoration: none; font-weight: 700; font-size: 15px; transition: all 0.2s ease; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15); white-space: nowrap;">
            <svg style="width: 20px; height: 20px;" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"/>
            </svg>
            Gestionar Limpieza
        </a>
    </div>
</div>

<div style="margin-top: 16px; padding: 14px; background: #F0F9FF; border-left: 4px solid #3B82F6; border-radius: 6px;">
    <p style="margin: 0; font-size: 13px; color: #1E3A8A; line-height: 1.5;">
        <strong>ℹ️ Información:</strong> Total de {{ total_blacklisted }} token(s) en la blacklist.
        {% if expired_blacklisted > 100 %}
            Se recomienda ejecutar la limpieza para mejorar el rendimiento.
        {% elif expired_blacklisted > 0 %}
            Algunos tokens pueden ser limpiados.
        {% else %}
            El sistema está optimizado.
        {% endif %}
    </p>
</div>
{% endblock %}
