<!-- Executive Summary -->
<div class="executive-summary">
    <h3>RESUMEN EJECUTIVO</h3>
    <div class="metrics-grid">
        <div class="metric-card">
            <div class="metric-label">Ingresos del Período</div>
            <div class="metric-value">{{ metrics.revenue.total|floatformat:2 }} Bs</div>
            {% if metrics.comparison.revenue.direction == 'up' %}
                <div class="metric-change">↑ +{{ metrics.comparison.revenue.percent }}% vs período anterior</div>
            {% elif metrics.comparison.revenue.direction == 'down' %}
                <div class="metric-change">↓ -{{ metrics.comparison.revenue.percent }}% vs período anterior</div>
            {% else %}
                <div class="metric-change">→ Sin cambios</div>
            {% endif %}
        </div>

        <div class="metric-card">
            <div class="metric-label">Planes Vendidos</div>
            <div class="metric-value">{{ metrics.plans.total_sold }}</div>
            {% if metrics.comparison.plans.direction == 'up' %}
                <div class="metric-change">↑ +{{ metrics.comparison.plans.percent }}%</div>
            {% elif metrics.comparison.plans.direction == 'down' %}
                <div class="metric-change">↓ -{{ metrics.comparison.plans.percent }}%</div>
            {% else %}
                <div class="metric-change">→ Sin cambios</div>
            {% endif %}
        </div>

        <div class="metric-card">
            <div class="metric-label">Nuevos Usuarios</div>
            <div class="metric-value">{{ metrics.users.new_total }}</div>
            <div class="metric-change">{{ metrics.users.new_companies }} empresas • {{ metrics.users.new_applicants }} postulantes</div>
        </div>

        <div class="metric-card">
            <div class="metric-label">Nuevas Publicaciones</div>
            <div class="metric-value">{{ metrics.jobs.new }}</div>
            <div class="metric-change">{{ metrics.applications.total }} aplicaciones recibidas</div>
        </div>
    </div>
</div>

<!-- Insights -->
{% if metrics.insights %}
<div class="insights-section">
    <h4>INSIGHTS CLAVE</h4>
    <ul>
        {% for insight in metrics.insights %}
            <li {% if 'ALERTA' in insight %}class="alert"{% endif %}>{{ insight }}</li>
        {% endfor %}
    </ul>
</div>
{% endif %}

<!-- Ingresos Detallados -->
<div class="section">
    <h3 class="section-title">Ingresos Detallados</h3>

    <table>
        <thead>
            <tr>
                <th>Concepto</th>
                <th style="text-align: right;">Cantidad</th>
                <th style="text-align: right;">Monto (Bs)</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><span class="badge badge-blue">Plan Estándar</span></td>
                <td style="text-align: right;">{{ metrics.plans.by_type.estandar }}</td>
                <td style="text-align: right;">{{ metrics.revenue.by_plan.estandar|floatformat:2 }}</td>
            </tr>
            <tr>
                <td><span class="badge badge-purple">Plan Púrpura</span></td>
                <td style="text-align: right;">{{ metrics.plans.by_type.purpura }}</td>
                <td style="text-align: right;">{{ metrics.revenue.by_plan.purpura|floatformat:2 }}</td>
            </tr>
            <tr>
                <td><span class="badge badge-green">Plan Impulso</span></td>
                <td style="text-align: right;">{{ metrics.plans.by_type.impulso }}</td>
                <td style="text-align: right;">{{ metrics.revenue.by_plan.impulso|floatformat:2 }}</td>
            </tr>
            <tr style="font-weight: 700; background: #f9fafb;">
                <td>TOTAL</td>
                <td style="text-align: right;">{{ metrics.plans.total_sold }}</td>
                <td style="text-align: right; color: #10b981;">{{ metrics.revenue.total|floatformat:2 }}</td>
            </tr>
        </tbody>
    </table>
</div>

<!-- Usuarios y Trabajos (Combinados) -->
<div class="section">
    <h3 class="section-title">Actividad del Período</h3>

    <table>
        <thead>
            <tr>
                <th>Métrica</th>
                <th style="text-align: right;">Cantidad</th>
            </tr>
        </thead>
        <tbody>
            <tr style="background: #f9fafb;">
                <td style="font-weight: 600;">USUARIOS</td>
                <td></td>
            </tr>
            <tr>
                <td>Nuevos usuarios totales</td>
                <td style="text-align: right; font-weight: 700; color: #7c3aed;">{{ metrics.users.new_total }}</td>
            </tr>
            <tr>
                <td>└─ Empresas nuevas</td>
                <td style="text-align: right;">{{ metrics.users.new_companies }}</td>
            </tr>
            <tr>
                <td>└─ Postulantes nuevos</td>
                <td style="text-align: right;">{{ metrics.users.new_applicants }}</td>
            </tr>
            <tr style="background: #f9fafb;">
                <td style="font-weight: 600;">OFERTAS DE TRABAJO</td>
                <td></td>
            </tr>
            <tr>
                <td>Nuevas publicaciones</td>
                <td style="text-align: right; font-weight: 700; color: #10b981;">{{ metrics.jobs.new }}</td>
            </tr>
            <tr>
                <td>Trabajos activos (total)</td>
                <td style="text-align: right;">{{ metrics.jobs.active }}</td>
            </tr>
            <tr>
                <td>Aplicaciones recibidas</td>
                <td style="text-align: right; font-weight: 700; color: #7c3aed;">{{ metrics.applications.total }}</td>
            </tr>
        </tbody>
    </table>
</div>

<!-- Comparación -->
<div class="section">
    <h3 class="section-title">Comparación con Período Anterior</h3>

    <table>
        <thead>
            <tr>
                <th>Métrica</th>
                <th style="text-align: right;">Cambio</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Ingresos</td>
                <td style="text-align: right;">
                    <span class="comparison-arrow {{ metrics.comparison.revenue.direction }}">
                        {% if metrics.comparison.revenue.direction == 'up' %}↑ +{{ metrics.comparison.revenue.percent }}%
                        {% elif metrics.comparison.revenue.direction == 'down' %}↓ -{{ metrics.comparison.revenue.percent }}%
                        {% else %}→ {{ metrics.comparison.revenue.percent }}%{% endif %}
                    </span>
                </td>
            </tr>
            <tr>
                <td>Planes vendidos</td>
                <td style="text-align: right;">
                    <span class="comparison-arrow {{ metrics.comparison.plans.direction }}">
                        {% if metrics.comparison.plans.direction == 'up' %}↑ +{{ metrics.comparison.plans.percent }}%
                        {% elif metrics.comparison.plans.direction == 'down' %}↓ -{{ metrics.comparison.plans.percent }}%
                        {% else %}→ {{ metrics.comparison.plans.percent }}%{% endif %}
                    </span>
                </td>
            </tr>
            <tr>
                <td>Nuevos usuarios</td>
                <td style="text-align: right;">
                    <span class="comparison-arrow {{ metrics.comparison.users.direction }}">
                        {% if metrics.comparison.users.direction == 'up' %}↑ +{{ metrics.comparison.users.percent }}%
                        {% elif metrics.comparison.users.direction == 'down' %}↓ -{{ metrics.comparison.users.percent }}%
                        {% else %}→ {{ metrics.comparison.users.percent }}%{% endif %}
                    </span>
                </td>
            </tr>
            <tr>
                <td>Nuevas publicaciones</td>
                <td style="text-align: right;">
                    <span class="comparison-arrow {{ metrics.comparison.jobs.direction }}">
                        {% if metrics.comparison.jobs.direction == 'up' %}↑ +{{ metrics.comparison.jobs.percent }}%
                        {% elif metrics.comparison.jobs.direction == 'down' %}↓ -{{ metrics.comparison.jobs.percent }}%
                        {% else %}→ {{ metrics.comparison.jobs.percent }}%{% endif %}
                    </span>
                </td>
            </tr>
        </tbody>
    </table>
</div>
